# Testing & Deployment Workflow

## Two Types of Testing

### 1. Local Testing (Before Deployment)
Test your business logic changes on your local machine first.

**When to use:**
- Testing backend logic/code changes
- Testing new API endpoints
- Testing database queries
- Catching bugs before deployment

**How to test:**
```bash
# Run backend locally
cd apps/backend
npm run dev
# Backend runs on http://localhost:3000

# Test with curl or browser
curl http://localhost:3000/api/orders
```

### 2. Deployment Testing (After Deployment)
Test your deployed environment on AWS.

**When to use:**
- Testing CloudFront/CDN behavior
- Testing API Gateway integration
- Testing CORS configuration
- Testing environment-specific issues
- Verifying production works

**How to test:**
```bash
# Test your deployment URL
curl https://your-cloudfront-url.cloudfront.net/api/orders
# or open in browser
```

---

## Complete Workflow

```
1. Make backend changes (e.g., fix OrderController.ts)
   ↓
2. Test locally
   - cd apps/backend
   - npm run dev
   - Test endpoints on localhost:3000
   ↓
3. If local tests PASS
   - git add .
   - git commit -m "Fix backend logic"
   - git push origin xiaoling-deployment
   ↓
4. Deploy to AWS
   - cd terraform
   - terraform apply
   ↓
5. Test deployment URL
   - Test your CloudFront URL
   ↓
6. If deployment test FAILS → go back to step 1
```

---

## Quick Decision Guide

| What are you fixing? | Can you test locally? | Must deploy to test? |
|---------------------|----------------------|---------------------|
| Business logic bug | ✅ Yes | ❌ No |
| API endpoint returns wrong data | ✅ Yes | ❌ No |
| Database query issue | ✅ Yes | ❌ No |
| CORS error | ❌ No | ✅ Yes |
| CloudFront not proxying | ❌ No | ✅ Yes |
| API Gateway issue | ❌ No | ✅ Yes |
| Environment variables | ⚠️ Partial | ✅ Yes |

---

## Best Practices

1. **Always test locally first** (if possible)
   - Catches bugs early
   - Faster iteration
   - Saves deployment time and costs

2. **Commit and push before deploying**
   - Maintains version control
   - Team can see what's deployed
   - Enables easy rollback

3. **Test deployment URL after every deploy**
   - Verifies the full stack works
   - Catches infrastructure issues
   - Confirms production is healthy

4. **Keep .terraform/ out of git**
   - Already added to .gitignore
   - These files are machine-specific
   - Generated by `terraform init`
